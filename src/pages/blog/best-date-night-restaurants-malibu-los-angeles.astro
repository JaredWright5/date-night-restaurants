---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getAllRestaurants } from '@/lib/supabase';

// Get restaurants from Supabase
let restaurants;
try {
  restaurants = await getAllRestaurants();
} catch (error) {
  console.error('Error fetching restaurants:', error);
  return new Response('Database connection failed. Please check your Supabase configuration.', { status: 500 });
}

// Filter for Malibu restaurants
const malibuRestaurants = restaurants.filter(r => r.neighborhood === 'Malibu');
const topRestaurants = malibuRestaurants
  .sort((a, b) => b.date_night_score - a.date_night_score)
  .slice(0, Math.min(6, malibuRestaurants.length));

// Calculate stats
const avgDateScore = Math.round(malibuRestaurants.reduce((sum, r) => sum + r.date_night_score, 0) / malibuRestaurants.length);
const upscaleCount = malibuRestaurants.filter(r => r.price_level >= 3).length;
const cuisineTypes = [...new Set(malibuRestaurants.flatMap(r => r.cuisine_types))];

const structuredData = {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": `Best Date Night Restaurants in Malibu | ${malibuRestaurants.length} Romantic Dining Spots`,
  "description": `Discover the best date night restaurants in Malibu, Los Angeles. From oceanfront fine dining to intimate coastal bistros, explore ${malibuRestaurants.length} romantic restaurants perfect for couples.`,
  "author": {
    "@type": "Organization",
    "name": "Date Night Restaurants"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Date Night Restaurants",
    "logo": {
      "@type": "ImageObject",
      "url": "https://datenightrestaurants.com/logo.png"
    }
  },
  "datePublished": "2025-11-05",
  "dateModified": "2025-11-05",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://datenightrestaurants.com/blog/best-date-night-restaurants-malibu-los-angeles"
  },
  "image": "https://images.unsplash.com/photo-1511882150382-421056c89033?w=1200&h=800&fit=crop"
};
---

<BaseLayout
  title={`Best Date Night Restaurants in Malibu | ${malibuRestaurants.length} Romantic Dining Spots`}
  description={`Discover the best date night restaurants in Malibu, Los Angeles. From oceanfront fine dining to intimate coastal bistros, explore ${malibuRestaurants.length} romantic restaurants perfect for couples.`}
  canonical="https://datenightrestaurants.com/blog/best-date-night-restaurants-malibu-los-angeles"
  keywords={['date night restaurants Malibu', 'romantic dining Malibu', 'couples restaurants Malibu', 'Malibu restaurants', 'oceanfront dining Malibu', 'Malibu Beach restaurants']}
  structuredData={structuredData}
>
  <article class="blog-post">
    <div class="container">
      <!-- Hero Section -->
      <header class="blog-hero">
        <div class="blog-hero-image">
          <img src="https://images.unsplash.com/photo-1511882150382-421056c89033?w=1200&h=800&fit=crop" alt="Malibu oceanfront restaurants and dining scene" />
        </div>
        <div class="blog-hero-content">
          <h1>Best Date Night Restaurants in Malibu</h1>
          <p class="blog-subtitle">Discover {malibuRestaurants.length} romantic dining spots along LA's stunning Pacific Coast</p>
          <div class="blog-meta">
            <span class="publish-date">Published: November 5, 2025</span>
            <span class="read-time">Reading time: 7 minutes</span>
          </div>
        </div>
      </header>

      <!-- Introduction -->
      <section class="blog-intro">
        <p>Malibu is Los Angeles' premier coastal destination, offering breathtaking ocean views, pristine beaches, and world-class dining. With {malibuRestaurants.length} exceptional date night restaurants, this exclusive community provides everything from casual beachside cafes to upscale oceanfront fine dining experiences perfect for romantic evenings.</p>
        
        <p>Whether you're looking for a sunset dinner overlooking the Pacific, fresh seafood at a coastal bistro, or an intimate fine dining experience with ocean views, Malibu's diverse culinary landscape offers unforgettable romantic moments. From the famous Malibu Pier to the scenic Pacific Coast Highway, discover the perfect spot for your next special date night.</p>
      </section>

      <!-- Quick Stats -->
      <section class="blog-stats">
        <div class="stat-card">
          <div class="stat-number">{malibuRestaurants.length}</div>
          <div class="stat-label">Restaurants</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{avgDateScore}</div>
          <div class="stat-label">Avg Date Score</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{upscaleCount}</div>
          <div class="stat-label">Upscale Options</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{cuisineTypes.length}</div>
          <div class="stat-label">Cuisine Types</div>
        </div>
      </section>

      <!-- Top Restaurants -->
      <section class="top-restaurants">
        <h2>Top {Math.min(6, malibuRestaurants.length)} Date Night Restaurants in Malibu</h2>
        <p>These handpicked restaurants offer the perfect combination of romantic ambiance, exceptional cuisine, and stunning ocean views for couples.</p>
        
        <div class="restaurants-grid">
          {topRestaurants.map((restaurant, index) => (
            <div class="restaurant-card">
              <div class="restaurant-rank">#{index + 1}</div>
              <h3><a href={`/losangeles/${restaurant.slug}/`}>{restaurant.name}</a></h3>
              <div class="restaurant-details">
                <span class="cuisine">{restaurant.cuisine_types?.join(', ') || 'Fine Dining'}</span>
                <span class="price">{'$'.repeat(restaurant.price_level)}</span>
                <span class="date-score">Date Score: {restaurant.date_night_score}</span>
              </div>
              <p class="restaurant-description">{restaurant.description || `A romantic dining experience in Malibu perfect for date nights.`}</p>
              <a href={`/losangeles/${restaurant.slug}/`} class="btn btn-primary">View Details</a>
            </div>
          ))}
        </div>
      </section>

      <!-- Neighborhood Highlights -->
      <section class="neighborhood-highlights">
        <h2>Why Malibu is Perfect for Date Nights</h2>
        
        <div class="highlights-grid">
          <div class="highlight-card">
            <h3>üåä Oceanfront Views</h3>
            <p>Malibu offers unparalleled Pacific Ocean views, creating a breathtaking backdrop for romantic dinners and unforgettable sunset moments.</p>
          </div>
          
          <div class="highlight-card">
            <h3>‚ú® Luxury Ambiance</h3>
            <p>The neighborhood's upscale atmosphere and refined dining establishments create an elegant and sophisticated setting perfect for special occasions.</p>
          </div>
          
          <div class="highlight-card">
            <h3>üåÖ Sunset Dining</h3>
            <p>Many restaurants offer spectacular sunset views over the Pacific Ocean, creating magical romantic experiences for couples.</p>
          </div>
          
          <div class="highlight-card">
            <h3>ü¶û Fresh Seafood</h3>
            <p>Malibu's coastal location means access to the freshest seafood, prepared by world-class chefs in romantic settings.</p>
          </div>
        </div>
      </section>

      <!-- Cuisine Diversity -->
      <section class="cuisine-diversity">
        <h2>Diverse Culinary Experiences</h2>
        <p>Malibu's restaurant scene reflects LA's coastal dining culture, offering couples the opportunity to explore cuisines from around the world:</p>
        
        <ul class="cuisine-list">
          {cuisineTypes.slice(0, 8).map(cuisine => (
            <li><a href={`/cuisines/${cuisine.toLowerCase().replace(/\s+/g, '-').replace(/_/g, '-')}/`}>{cuisine.replace(/_/g, ' ')}</a></li>
          ))}
        </ul>
        
        <p>From fresh seafood restaurants to international fine dining, each restaurant brings its own unique atmosphere and culinary expertise to create memorable date night experiences.</p>
      </section>

      <!-- Planning Your Date Night -->
      <section class="planning-tips">
        <h2>Planning Your Malibu Date Night</h2>
        
        <div class="tips-grid">
          <div class="tip-card">
            <h3>üïê Best Times to Visit</h3>
            <p>Sunset hours (5-7 PM) offer the most spectacular views and romantic atmosphere. Reservations are essential, especially on weekends and during summer months.</p>
          </div>
          
          <div class="tip-card">
            <h3>üÖøÔ∏è Parking Tips</h3>
            <p>Parking can be limited in Malibu, especially near the beach. Many restaurants offer valet service, which is recommended for a stress-free experience.</p>
          </div>
          
          <div class="tip-card">
            <h3>üëó Dress Code</h3>
            <p>Malibu restaurants typically require smart casual to upscale attire. Check restaurant websites for specific dress codes, especially at fine dining establishments.</p>
          </div>
          
          <div class="tip-card">
            <h3>üåä Beach Walk</h3>
            <p>Many couples enjoy a romantic stroll on Malibu's pristine beaches before or after dinner. The scenic coastline offers perfect photo opportunities and quiet moments together.</p>
          </div>
        </div>
      </section>

      <!-- Related Content -->
      <section class="related-content">
        <h2>Explore More Date Night Options</h2>
        <div class="related-links">
          <a href="/losangeles/restaurants/neighborhoods/malibu/" class="related-link">
            <h3>All Malibu Restaurants</h3>
            <p>Browse our complete list of {malibuRestaurants.length} restaurants in Malibu</p>
          </a>
          
          <a href="/losangeles/restaurants/neighborhoods/santa-monica/" class="related-link">
            <h3>Santa Monica Restaurants</h3>
            <p>Discover romantic oceanfront dining in neighboring Santa Monica</p>
          </a>
          
          <a href="/losangeles/restaurants/neighborhoods/manhattan-beach/" class="related-link">
            <h3>Manhattan Beach Restaurants</h3>
            <p>Explore more beachside dining options south of Malibu</p>
          </a>
          
          <a href="/blog/outdoor-dining-los-angeles/" class="related-link">
            <h3>Outdoor Dining in LA</h3>
            <p>Find the perfect outdoor dining spots for romantic evenings</p>
          </a>
        </div>
      </section>

      <!-- Call to Action -->
      <section class="cta-section">
        <h2>Ready for Your Next Date Night?</h2>
        <p>With {malibuRestaurants.length} exceptional restaurants to choose from, Malibu offers endless possibilities for romantic dining. Whether you're planning a special celebration or a casual coastal date, you're sure to find the perfect spot.</p>
        <div class="cta-buttons">
          <a href="/losangeles/restaurants/neighborhoods/malibu/" class="btn btn-primary">View All Malibu Restaurants</a>
          <a href="/losangeles/restaurants/" class="btn btn-secondary">Explore All LA Restaurants</a>
        </div>
      </section>
    </div>
  </article>
</BaseLayout>

<style>
  .blog-post {
    padding-top: 80px;
    background: #F8F6F0;
    min-height: 100vh;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  .blog-hero {
    text-align: center;
    padding: 4rem 0;
    background: linear-gradient(135deg, #2C2C2C 0%, #1a1a1a 100%);
    color: white;
    margin-bottom: 3rem;
  }

  .blog-hero h1 {
    font-size: 3.5rem;
    margin-bottom: 1rem;
    color: #D4AF37;
    font-family: 'Playfair Display', serif;
  }

  .blog-subtitle {
    font-size: 1.3rem;
    margin-bottom: 2rem;
    color: #e0e0e0;
  }

  .blog-meta {
    display: flex;
    justify-content: center;
    gap: 2rem;
    font-size: 0.9rem;
    color: #ccc;
  }

  .blog-intro {
    background: white;
    padding: 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-bottom: 3rem;
    font-size: 1.1rem;
    line-height: 1.8;
  }

  .blog-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 2rem;
    margin-bottom: 4rem;
  }

  .stat-card {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }

  .stat-number {
    font-size: 3rem;
    font-weight: 700;
    color: #D4AF37;
    margin-bottom: 0.5rem;
  }

  .stat-label {
    font-size: 1rem;
    color: #666;
    font-weight: 600;
  }

  .top-restaurants {
    background: white;
    padding: 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-bottom: 4rem;
  }

  .top-restaurants h2 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    color: #2C2C2C;
  }

  .top-restaurants > p {
    font-size: 1.1rem;
    color: #666;
    margin-bottom: 2rem;
  }

  .restaurants-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .restaurant-card {
    border: 2px solid #E8B86D;
    border-radius: 12px;
    padding: 2rem;
    background: #FDF8F3;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .restaurant-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(139, 69, 19, 0.2);
  }

  .restaurant-rank {
    background: #8B4513;
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 1rem;
  }

  .restaurant-card h3 {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    color: #2C1810;
  }

  .restaurant-card h3 a {
    color: #2C1810;
    text-decoration: none;
  }

  .restaurant-card h3 a:hover {
    color: #8B4513;
  }

  .restaurant-details {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .restaurant-details span {
    background: #E8B86D;
    color: #2C1810;
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .restaurant-description {
    color: #666;
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }

  .neighborhood-highlights {
    background: white;
    padding: 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-bottom: 4rem;
  }

  .neighborhood-highlights h2 {
    font-size: 2.5rem;
    margin-bottom: 2rem;
    color: #2C2C2C;
  }

  .highlights-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
  }

  .highlight-card {
    padding: 2rem;
    background: #FDF8F3;
    border-radius: 12px;
    border: 2px solid #E8B86D;
  }

  .highlight-card h3 {
    font-size: 1.3rem;
    margin-bottom: 1rem;
    color: #2C1810;
  }

  .highlight-card p {
    color: #666;
    line-height: 1.6;
  }

  .cuisine-diversity {
    background: white;
    padding: 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-bottom: 4rem;
  }

  .cuisine-diversity h2 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    color: #2C2C2C;
  }

  .cuisine-diversity > p {
    font-size: 1.1rem;
    color: #666;
    margin-bottom: 2rem;
  }

  .cuisine-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    list-style: none;
    padding: 0;
    margin-bottom: 2rem;
  }

  .cuisine-list li {
    background: #FDF8F3;
    padding: 1rem;
    border-radius: 8px;
    border: 2px solid #E8B86D;
  }

  .cuisine-list a {
    color: #8B4513;
    text-decoration: none;
    font-weight: 600;
  }

  .cuisine-list a:hover {
    color: #2C1810;
  }

  .planning-tips {
    background: white;
    padding: 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-bottom: 4rem;
  }

  .planning-tips h2 {
    font-size: 2.5rem;
    margin-bottom: 2rem;
    color: #2C2C2C;
  }

  .tips-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
  }

  .tip-card {
    padding: 2rem;
    background: #FDF8F3;
    border-radius: 12px;
    border: 2px solid #E8B86D;
  }

  .tip-card h3 {
    font-size: 1.3rem;
    margin-bottom: 1rem;
    color: #2C1810;
  }

  .tip-card p {
    color: #666;
    line-height: 1.6;
  }

  .related-content {
    background: white;
    padding: 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-bottom: 4rem;
  }

  .related-content h2 {
    font-size: 2.5rem;
    margin-bottom: 2rem;
    color: #2C2C2C;
  }

  .related-links {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
  }

  .related-link {
    display: block;
    padding: 2rem;
    background: #FDF8F3;
    border-radius: 12px;
    border: 2px solid #E8B86D;
    text-decoration: none;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .related-link:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(139, 69, 19, 0.2);
  }

  .related-link h3 {
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
    color: #2C1810;
  }

  .related-link p {
    color: #666;
    line-height: 1.6;
  }

  .cta-section {
    background: white;
    padding: 4rem 3rem;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    text-align: center;
    margin-bottom: 4rem;
  }

  .cta-section h2 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    color: #2C2C2C;
  }

  .cta-section p {
    font-size: 1.1rem;
    color: #666;
    margin-bottom: 2rem;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .cta-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn {
    display: inline-block;
    padding: 1rem 2rem;
    border-radius: 25px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
  }

  .btn-primary {
    background: #8B4513;
    color: #F5F1E8;
  }

  .btn-primary:hover {
    background: #A0522D;
    transform: translateY(-2px);
  }

  .btn-secondary {
    background: #E8B86D;
    color: #2C1810;
  }

  .btn-secondary:hover {
    background: #D4A86A;
    transform: translateY(-2px);
  }

  .blog-hero-image {
    width: 100%;
    height: 400px;
    border-radius: 15px;
    overflow: hidden;
    margin-bottom: 2rem;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  }

  .blog-hero-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .blog-hero-content {
    text-align: center;
  }

  @media (max-width: 768px) {
    .blog-hero h1 {
      font-size: 2.5rem;
    }
    
    .blog-subtitle {
      font-size: 1.1rem;
    }
    
    .restaurants-grid,
    .highlights-grid,
    .tips-grid,
    .related-links {
      grid-template-columns: 1fr;
    }
  }
</style>

